<html>
	<head>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
		<script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
		<style>
			* { 
				box-sizing: border-box;
				margin: 0 0;
			}

			#map {
				width: 100%;
				height: 100%;
				display: block;
				background: blue;
			}

			#filter {
				position: absolute;
				right: 20px;
				top: 20px;
				display: block;
				z-index: 2000;
				background: white;
			}

		</style>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	</head>
	<body>
		<div id=map>
		</div>
		<div id=filter>
			<h2>Filter</h2>
			<a href="#" onclick="filterPoints()">Filter</a>

		</div>

		<script>
			// create a map in the "map" div, set the view to a given place and zoom
			var map = L.map('map').setView([52.505, 13.25], 12);

			// add an OpenStreetMap tile layer
			L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(map);
			var containers;
			$.getJSON("/all.gjson", function(data) {
				containers = data;
			})
			.done(function(){
				add_containers(containers);
			});


			function filterPoints(){
				var filteredContainers = [];
				$.each(containers.features, function(index, container) {
					if (container.properties.data.braun === ""){
						filteredContainers.push(container)
					}
				});
				add_containers(filteredContainers);
			}

			var allContainers = [];
			function add_containers(data){
				map.removeLayer(allContainers);
				allContainers = L.geoJson(data, {
					onEachFeature: function (feature, layer) {
						layer.bindPopup(feature.properties.description + '<br />');
					}

				}).addTo(map);
			}
		</script>

	</body>
</html>
